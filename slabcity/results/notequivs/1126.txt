7: select distinct business_id from events as e join (select event_type, avg(occurences) as avg_occ from events group by event_type) as tmp on e.event_type = tmp.event_type where e.occurences > tmp.avg_occ group by business_id having count(business_id) > 1;
2: select distinct a.business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as mean from events) as a where a.occurences > a.mean group by a.business_id having count(distinct a.event_type) > 1;
1: select distinct events.business_id from events join (select event_type, avg(occurences) as mean from events group by event_type) as t on (t.event_type = events.event_type and occurences > mean) group by business_id having count(business_id) > 1;
180: select business_id from (select a.business_id, a.event_type from events as a left outer join (select event_type, avg(occurences) as avg_occur from events group by event_type) as cte on a.event_type = cte.event_type where a.occurences > cte.avg_occur) as cte2 group by business_id having count(event_type) > 1;
214: select business_id from events as e1 left outer join (select event_type, avg(occurences) as avg_occ from events group by event_type) as e2 on e1.event_type = e2.event_type where e1.occurences > e2.avg_occ group by business_id having count(distinct e1.event_type) > 1;
165: select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avgocc from events) as t1 where occurences > avgocc group by 1 having count(event_type) > 1;
160: select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_occurences from events) as t where occurences > avg_occurences group by 1 having count(event_type) > 1;
6: select distinct business_id from events as a join (select event_type, avg(occurences) as avg_occur from events group by event_type) as b on (a.event_type = b.event_type and a.occurences > b.avg_occur) group by a.business_id having count(a.event_type) > 1;
11: select e3.business_id from (select business_id from events as e1 left outer join (select event_type, avg(occurences) as avg_occurences from events group by event_type) as e2 on e1.event_type = e2.event_type where e1.occurences > e2.avg_occurences) as e3 group by e3.business_id having count(business_id) > 1;
53: select c.business_id from (select b.business_id, count(b.event_type) as event_count from (select a.business_id, a.event_type from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_occurences from events) as a where a.occurences > a.avg_occurences) as b group by b.business_id) as c where c.event_count > 1;
212: select business_id from events as e1 left outer join (select event_type, avg(occurences) as avg from events group by event_type) as e2 on e1.event_type = e2.event_type where e1.occurences > e2.avg group by business_id having count(e1.event_type) > 1;
253: select e.business_id from events as e left outer join (select event_type, avg(occurences) as avg_occ from events group by event_type) as t on e.event_type = t.event_type where e.occurences > t.avg_occ group by e.business_id having count(e.business_id) > 1;
163: select business_id from (select business_id, event_type, occurences, count(event_type) over (partition by business_id) as cnt, avg(occurences) over (partition by event_type) as avgocc from events) as t1 where occurences > avgocc group by 1 having count(business_id) > 1;
261: select t2.business_id from (select e.business_id, count(e.event_type) as event_count from (select event_type, avg(occurences) as avg_occ from events group by event_type) as t1 left outer join events as e on (t1.event_type = e.event_type and e.occurences > t1.avg_occ) group by e.business_id) as t2 where t2.event_count > 1;
159: select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_occurances from events) as asd where occurences > asd.avg_occurances group by business_id having count(event_type) > 1;
8: select distinct e.business_id from events as e left outer join (select event_type, avg(occurences) as avg_occur from events group by event_type) as x on e.event_type = x.event_type where e.occurences > x.avg_occur group by e.business_id having count(distinct e.event_type) > 1;
193: select business_id from (select business_id, event_type, occurences, avg(occurences) over (partition by event_type) as avg_o from events) as t where occurences > avg_o group by business_id having count(business_id) > 1;
