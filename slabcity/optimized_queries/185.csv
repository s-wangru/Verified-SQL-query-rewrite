427,"SELECT d.name AS department, e.name AS employee, salary FROM (SELECT e1.id, count(DISTINCT e2.salary) AS rk FROM Employee e1 JOIN Employee e2 ON e1.salary <= e2.salary WHERE e1.DepartmentId = e2.DepartmentId GROUP BY e1.id HAVING count(DISTINCT e2.salary) <= 3) temp JOIN Employee e ON temp.id = e.id JOIN Department d ON e.DepartmentId = d.id"
434,"SELECT d.name AS department, e.name AS employee, e.salary FROM Department as d JOIN (SELECT e1.name, e1.salary, e1.departmentid FROM Employee e1 WHERE (SELECT COUNT(DISTINCT e2.salary) FROM Employee e2 WHERE e1.departmentid = e2.departmentid AND e1.salary <= e2.salary) <= 3) as e ON e.departmentid = d.id ORDER BY d.name, e.salary DESC"
