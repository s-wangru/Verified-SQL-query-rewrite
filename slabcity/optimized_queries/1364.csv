10,"SELECT a.invoice_id, b.customer_name, a.price, COUNT(c.user_id) AS contacts_cnt, COUNT(d.customer_name) AS trusted_contacts_cnt FROM Invoices a LEFT JOIN Customers b ON a.user_id = b.customer_id LEFT JOIN Contacts c ON a.user_id = c.user_id LEFT JOIN Customers d ON c.contact_name = d.customer_name GROUP BY 1, 2, 3 ORDER BY 1"
15,"SELECT i.invoice_id, c1.customer_name, i.price, COUNT(m.contact_email) AS contacts_cnt, COUNT(c2.email) AS trusted_contacts_cnt FROM Invoices AS i LEFT JOIN Customers AS c1 ON i.user_id = c1.customer_id LEFT JOIN Contacts AS m ON c1.customer_id = m.user_id LEFT JOIN Customers AS c2 ON m.contact_name = c2.customer_name AND m.contact_email = c2.email GROUP BY i.invoice_id, c1.customer_name, i.price ORDER BY i.invoice_id;
"
43,"SELECT i.invoice_id, us.customer_name, i.price, COUNT(co.contact_name) AS contacts_cnt, COUNT(cu.customer_name) AS trusted_contacts_cnt FROM Invoices i LEFT OUTER JOIN Contacts co ON i.user_id=co.user_id LEFT OUTER JOIN Customers cu ON co.contact_name=cu.customer_name LEFT OUTER JOIN Customers us ON us.customer_id=i.user_id GROUP BY i.invoice_id, us.customer_name, i.price ORDER BY i.invoice_id"
135,"SELECT c.invoice_id, a.customer_name, c.price, COUNT(b.contact_name) AS contacts_cnt, COUNT(DISTINCT d.customer_name) AS trusted_contacts_cnt FROM Invoices c LEFT JOIN Customers a ON c.user_id = a.customer_id LEFT JOIN Contacts b ON a.customer_id = b.user_id LEFT JOIN Customers d ON b.contact_name = d.customer_name GROUP BY c.invoice_id, a.customer_name, c.price"
188,"SELECT i.invoice_id, MIN(cust.customer_name) AS customer_name, MIN(i.price) AS price, COUNT(con.contact_name) AS contacts_cnt, COUNT(cust2.email) AS trusted_contacts_cnt FROM Invoices AS i LEFT JOIN Customers AS cust ON i.user_id = cust.customer_id LEFT JOIN Contacts AS con ON i.user_id = con.user_id LEFT JOIN Customers AS cust2 ON con.contact_name = cust2.customer_name GROUP BY i.invoice_id ORDER BY i.invoice_id"
204,"SELECT i.invoice_id, c.customer_name, i.price, COUNT(o.contact_name) AS contacts_cnt, COUNT(a.email) AS trusted_contacts_cnt FROM Invoices i LEFT JOIN Customers c ON i.user_id = c.customer_id LEFT JOIN Contacts o ON c.customer_id = o.user_id LEFT JOIN Customers a ON a.email = o.contact_email GROUP BY i.invoice_id, c.customer_name, i.price ORDER BY i.invoice_id"
228,"SELECT invoice_id, customer_name, price, COUNT(DISTINCT contact_name) AS contacts_cnt, COUNT(DISTINCT contact_customer_name) AS trusted_contacts_cnt FROM (SELECT i.invoice_id, c.customer_name, i.price, co.contact_name, cu.customer_name AS contact_customer_name FROM Invoices AS i LEFT OUTER JOIN Customers AS c ON i.user_id = c.customer_id LEFT OUTER JOIN Contacts AS co ON i.user_id = co.user_id LEFT OUTER JOIN Customers AS cu ON co.contact_name = cu.customer_name) AS t GROUP BY invoice_id, customer_name, price"
233,"SELECT Invoices.invoice_id, Customers.customer_name, Invoices.price, COUNT(Contacts.contact_name) AS contacts_cnt, COUNT(emails.email) AS trusted_contacts_cnt FROM Invoices LEFT JOIN Customers ON Invoices.user_id = Customers.customer_id LEFT JOIN Contacts ON Invoices.user_id = Contacts.user_id LEFT JOIN Customers AS emails ON Contacts.contact_email = emails.email GROUP BY Invoices.invoice_id, Invoices.price, Customers.customer_name ORDER BY Invoices.invoice_id"
