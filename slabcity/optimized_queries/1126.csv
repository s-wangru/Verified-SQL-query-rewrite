1,"SELECT business_id FROM (SELECT business_id, COUNT(*) AS count FROM events WHERE occurences > (SELECT AVG(occurences) FROM events GROUP BY event_type) GROUP BY business_id) AS grouped WHERE count > 1"
2,"SELECT a.business_id FROM (SELECT business_id, AVG(occurences) OVER (PARTITION BY event_type) AS mean, COUNT(DISTINCT event_type) OVER (PARTITION BY business_id) as type_count FROM events) AS a WHERE a.occurences > a.mean AND a.type_count > 1 GROUP BY a.business_id"
6,"SELECT business_id FROM (SELECT business_id, COUNT(event_type) as count_types FROM events a JOIN (SELECT event_type, AVG(occurences) as avg_occur FROM events GROUP BY event_type) b ON a.event_type = b.event_type WHERE a.occurences > b.avg_occur GROUP BY business_id) c WHERE c.count_types > 1"
7,"SELECT business_id FROM (SELECT e.business_id, e.event_type, AVG(e.occurences) OVER(PARTITION BY e.event_type) as avg_occ FROM events e) as e WHERE e.occurences > e.avg_occ GROUP BY business_id HAVING COUNT(*) > 1"
8,"SELECT e.business_id FROM Events e WHERE e.business_id IN (SELECT business_id FROM Events GROUP BY business_id HAVING COUNT(DISTINCT event_type) > 1) AND e.occurences > (SELECT AVG(occurences) FROM Events WHERE event_type = e.event_type GROUP BY event_type)"
9,"SELECT e.business_id FROM Events AS e JOIN (SELECT event_type, AVG(occurences) AS average FROM Events GROUP BY event_type) AS t ON e.event_type = t.event_type WHERE e.occurences > t.average GROUP BY e.business_id HAVING COUNT(*) > 1"
10,"SELECT e1.business_id FROM Events e1 JOIN (SELECT event_type, AVG(occurences) avgoc FROM Events GROUP BY event_type) e2 ON e1.event_type = e2.event_type WHERE e1.occurences > e2.avgoc GROUP BY e1.business_id HAVING COUNT(DISTINCT e1.event_type) > 1"
11,"SELECT business_id FROM (SELECT e1.business_id, AVG(e2.occurences) OVER (PARTITION BY e1.event_type) as avg_occurences FROM events e1 JOIN events e2 ON e1.event_type = e2.event_type WHERE e1.occurences > avg_occurences) e3 GROUP BY business_id HAVING COUNT(*) > 1"
13,"SELECT a.business_id FROM (SELECT business_id, event_type, occurences, AVG(occurences) OVER (PARTITION BY event_type) AS avg_occurences_event FROM events) AS a WHERE a.occurences > a.avg_occurences_event GROUP BY a.business_id HAVING COUNT(a.event_type) > 1"
16,"SELECT a.business_id FROM events AS a INNER JOIN (SELECT event_type, AVG(occurences) AS avgocc FROM events GROUP BY event_type) AS b ON a.event_type = b.event_type WHERE a.occurences > b.avgocc GROUP BY a.business_id HAVING COUNT(a.event_type) > 1"
17,"SELECT a.business_id FROM Events AS a INNER JOIN (SELECT event_type, AVG(occurences) AS avg_occ_by_event FROM Events GROUP BY event_type) AS b ON a.event_type = b.event_type WHERE a.occurences > b.avg_occ_by_event GROUP BY a.business_id HAVING COUNT(DISTINCT a.event_type) > 1"
23,"SELECT business_id FROM (SELECT business_id, occurences, AVG(occurences) OVER (PARTITION BY event_type) AS avg_occ FROM Events) t WHERE occurences > avg_occ GROUP BY business_id HAVING COUNT(*) > 1"
37,"SELECT business_id FROM (SELECT business_id, occurences, AVG(occurences) OVER (PARTITION BY event_type) AS avg FROM Events) AS b WHERE occurences > avg GROUP BY business_id HAVING COUNT(*) >= 2"
39,"SELECT business_id FROM (SELECT business_id, event_type, occurences, AVG(occurences) OVER(PARTITION BY event_type) as average FROM Events) AS t1 WHERE occurences > average GROUP BY business_id HAVING COUNT(*) >= 2"
40,"SELECT e.business_id FROM Events e INNER JOIN (SELECT event_type, AVG(occurences) AS avg_occurences FROM Events GROUP BY event_type) t ON e.event_type = t.event_type WHERE e.occurences > t.avg_occurences GROUP BY e.business_id HAVING COUNT(DISTINCT e.event_type) > 1"
42,"SELECT business_id FROM Events e JOIN (SELECT event_type, AVG(occurences) AS average_occurences FROM Events GROUP BY event_type) average ON e.event_type = average.event_type WHERE e.occurences > average.average_occurences GROUP BY e.business_id HAVING COUNT(*) > 1"
43,"SELECT business_id FROM (SELECT business_id, event_type, occurences, AVG(occurences) OVER (PARTITION BY event_type) AS avg_occ FROM events) AS evt WHERE occurences > avg_occ GROUP BY business_id HAVING COUNT(event_type) > 1"
45,"SELECT e.business_id FROM Events e INNER JOIN (SELECT event_type, AVG(occurences) AS occurence_avg FROM Events GROUP BY event_type) ev on e.event_type = ev.event_type WHERE e.occurences > ev.occurence_avg GROUP BY e.business_id HAVING COUNT(*) > 1"
46,"SELECT e.business_id FROM Events as e INNER JOIN (SELECT event_type, AVG(occurences) as avg_occurences FROM Events GROUP BY event_type) as m ON e.event_type = m.event_type WHERE e.occurences > m.avg_occurences GROUP BY e.business_id HAVING COUNT(DISTINCT e.event_type) > 1"
52,"SELECT e.business_id FROM Events e INNER JOIN (SELECT event_type, AVG(occurences) as avg_occurence FROM Events GROUP BY event_type) t ON e.event_type = t.event_type AND e.occurences > t.avg_occurence GROUP BY e.business_id HAVING COUNT(DISTINCT e.event_type) > 1"
53,"SELECT business_id FROM (SELECT business_id, COUNT(event_type) AS event_count FROM (SELECT business_id, event_type FROM events WHERE occurences > (SELECT AVG(occurences) FROM events GROUP BY event_type)) AS b GROUP BY business_id) AS c WHERE c.event_count > 1"
54,"SELECT e.business_id FROM Events e JOIN (SELECT event_type, AVG(occurences) AS average FROM Events GROUP BY event_type) e2 ON e.event_type = e2.event_type WHERE e.occurences > e2.average GROUP BY e.business_id HAVING COUNT(*) > 1"
56,"SELECT e.business_id FROM events AS e LEFT JOIN (SELECT event_type, AVG(occurences) as avg_occ FROM events GROUP BY event_type) AS t ON e.event_type = t.event_type WHERE e.occurences > t.avg_occ GROUP BY e.business_id HAVING COUNT(DISTINCT e.event_type) > 1"
58,"SELECT e.business_id FROM events AS e JOIN (SELECT event_type, AVG(occurences) AS avg_occ FROM events GROUP BY event_type) AS t ON e.event_type = t.event_type WHERE e.occurences > t.avg_occ GROUP BY e.business_id HAVING COUNT(DISTINCT e.event_type) > 1"
60,"SELECT e.business_id FROM events AS e JOIN (SELECT event_type, AVG(occurences) AS avg_occur FROM events GROUP BY event_type) AS t1 ON e.event_type = t1.event_type WHERE e.occurences > t1.avg_occur GROUP BY e.business_id HAVING COUNT(DISTINCT e.event_type) > 1"
61,"SELECT business_id FROM (SELECT business_id, event_type, occurences, AVG(occurences) OVER (PARTITION BY event_type) AS average FROM events) AS t WHERE occurences > average GROUP BY business_id HAVING COUNT(event_type) > 1"
134,"SELECT e.business_id FROM Events e INNER JOIN (SELECT event_type, AVG(occurences) AS avg_occ FROM Events GROUP BY event_type) t1 ON e.event_type = t1.event_type WHERE e.occurences > t1.avg_occ GROUP BY e.business_id HAVING COUNT(e.event_type) > 1"
135,"SELECT e.business_id FROM Events e LEFT JOIN (SELECT event_type, AVG(occurences) AS average FROM Events GROUP BY event_type) AS t2 ON e.event_type = t2.event_type WHERE e.occurences > t2.average GROUP BY e.business_id HAVING COUNT(DISTINCT e.event_type) > 1"
138,"SELECT a.business_id FROM events a INNER JOIN (SELECT event_type, AVG(occurences) as avg_occurence FROM events GROUP BY event_type) b ON a.event_type = b.event_type WHERE a.occurences > b.avg_occurence GROUP BY a.business_id HAVING COUNT(DISTINCT a.event_type) > 1"
141,"SELECT a.business_id FROM events a INNER JOIN (SELECT event_type, AVG(occurences) as mean FROM events GROUP BY event_type) c ON a.event_type = c.event_type WHERE a.occurences > c.mean GROUP BY a.business_id HAVING COUNT(*) >= 2"
142,"SELECT a.business_id FROM Events AS a INNER JOIN (SELECT AVG(occurences) AS avg_occ, event_type FROM Events GROUP BY event_type) AS b ON a.event_type = b.event_type WHERE a.occurences > b.avg_occ GROUP BY a.business_id HAVING COUNT(*) > 1"
151,"SELECT a.business_id FROM Events a JOIN (SELECT event_type, AVG(occurences) AS event_avg FROM Events GROUP BY event_type) b ON a.event_type = b.event_type WHERE a.occurences > b.event_avg GROUP BY a.business_id HAVING COUNT(a.event_type) > 1"
155,"SELECT business_id FROM (SELECT business_id, AVG(occurences) OVER (PARTITION BY event_type) AS avg_occ, occurences FROM events) AS e WHERE occurences > avg_occ GROUP BY business_id HAVING COUNT(*) > 1"
157,"SELECT business_id FROM (SELECT business_id, COUNT(event_type) as cnt FROM (SELECT business_id, event_type, occurences, AVG(occurences) OVER (PARTITION BY event_type) as average FROM events) AS t WHERE occurences > average GROUP BY business_id) as t WHERE cnt > 1"
159,"SELECT business_id FROM Events WHERE occurences >(SELECT AVG(occurences) FROM Events GROUP BY event_type) GROUP BY business_id HAVING COUNT(event_type) > 1"
160,"SELECT business_id FROM (SELECT business_id, event_type, occurences, AVG(occurences) OVER (PARTITION BY event_type) AS avg_occurences FROM events WHERE occurences > AVG(occurences) OVER (PARTITION BY event_type)) as t GROUP BY business_id HAVING COUNT(event_type) > 1"
162,"SELECT t1.business_id FROM (SELECT business_id, event_type, SUM(occurences) AS occ FROM Events GROUP BY business_id, event_type) as t1 LEFT JOIN (SELECT event_type, AVG(occurences) AS avg_occ FROM Events GROUP BY event_type) as t2 ON t1.event_type = t2.event_type WHERE t1.occ > t2.avg_occ GROUP BY t1.business_id HAVING COUNT(*) > 1"
163,"SELECT business_id FROM (SELECT business_id, occurences, AVG(occurences) OVER (PARTITION BY event_type) AS avgocc, COUNT(event_type) OVER (PARTITION BY business_id) as cnt FROM events) AS t1 WHERE occurences > avgocc GROUP BY business_id HAVING cnt > 1"
164,"SELECT business_id FROM (SELECT business_id, occurences - AVG(occurences) OVER (PARTITION BY event_type) as diff FROM events) as t1 WHERE diff > 0 GROUP BY 1 HAVING COUNT(*) > 1"
165,"SELECT business_id FROM Events WHERE occurences > (SELECT AVG(occurences) FROM Events GROUP BY event_type) GROUP BY business_id HAVING COUNT(event_type) > 1"
166,"SELECT e.business_id 
FROM Events e 
INNER JOIN (
    SELECT event_type, AVG(occurences) AS avgo 
    FROM Events 
    GROUP BY event_type
) AS tmp 
ON e.event_type = tmp.event_type 
WHERE e.occurences > tmp.avgo 
GROUP BY e.business_id 
HAVING COUNT(e.event_type) > 1"
178,"SELECT business_id FROM events a INNER JOIN (SELECT event_type, AVG(occurences) avg_occur FROM events GROUP BY event_type) b ON a.event_type = b.event_type WHERE a.occurences > b.avg_occur GROUP BY a.business_id HAVING COUNT(DISTINCT a.event_type) > 1"
180,"SELECT business_id FROM events INNER JOIN (SELECT event_type, AVG(occurences) AS avg_occur FROM events GROUP BY event_type) AS cte ON events.event_type = cte.event_type WHERE events.occurences > cte.avg_occur GROUP BY business_id HAVING COUNT(event_type) > 1"
188,"SELECT business_id FROM (SELECT business_id, event_type, AVG(occurences) OVER (PARTITION BY event_type) AS event_avg, occurences FROM events) AS t WHERE occurences > event_avg GROUP BY business_id HAVING COUNT(DISTINCT event_type) > 1"
189,"SELECT business_id FROM (SELECT business_id, event_type, occurences, AVG(occurences) OVER (PARTITION BY event_type) AS average FROM events) AS a WHERE occurences > average GROUP BY business_id HAVING COUNT(event_type) >= 2"
190,"SELECT business_id FROM (SELECT business_id, occurences - AVG(occurences) OVER (PARTITION BY event_type) as diff_avg_event_occur FROM Events) as sub WHERE diff_avg_event_occur > 0 GROUP BY business_id HAVING COUNT(*) > 1"
193,"SELECT business_id FROM (SELECT business_id, AVG(occurences) OVER (PARTITION BY event_type) AS avg_o FROM Events) AS t WHERE occurences > avg_o GROUP BY business_id HAVING COUNT(*) > 1"
195,"SELECT business_id FROM (SELECT business_id, occurences, AVG(occurences) OVER (PARTITION BY event_type) as avg_occ FROM Events) as a WHERE a.occurences > a.avg_occ GROUP BY business_id HAVING COUNT(*) > 1"
196,"SELECT e2.business_id FROM (SELECT event_type, AVG(occurences) AS ave_occurences FROM Events GROUP BY event_type) AS e1 JOIN Events AS e2 ON e1.event_type = e2.event_type WHERE e2.occurences > e1.ave_occurences GROUP BY e2.business_id HAVING COUNT(DISTINCT e1.event_type) > 1"
197,"SELECT e2.business_id FROM Events e2 INNER JOIN (SELECT event_type, AVG(occurences) AS ave_occurences FROM Events GROUP BY event_type) e1 ON e1.event_type = e2.event_type WHERE e2.occurences > e1.ave_occurences GROUP BY e2.business_id HAVING COUNT(DISTINCT e2.event_type) > 1"
198,"SELECT business_id FROM Events e1 JOIN (SELECT event_type, AVG(occurences) as ave_occurences FROM Events GROUP BY event_type) temp1 ON e1.event_type = temp1.event_type WHERE e1.occurences > temp1.ave_occurences GROUP BY e1.business_id HAVING COUNT(DISTINCT e1.event_type) > 1"
200,"SELECT temp2.business_id FROM (SELECT event_type, AVG(occurences) AS avg_events FROM events GROUP BY event_type) temp1 INNER JOIN events temp2 ON temp1.event_type = temp2.event_type WHERE temp2.occurences > temp1.avg_events GROUP BY temp2.business_id HAVING COUNT(DISTINCT temp2.event_type) > 1"
203,"SELECT business_id FROM (SELECT business_id, event_type, occurences, AVG(occurences) OVER(PARTITION BY event_type) as avg_occurences FROM events) as a WHERE a.occurences > a.avg_occurences GROUP BY business_id HAVING COUNT(DISTINCT event_type) > 1"
204,"SELECT a.business_id FROM (SELECT business_id, event_type, occurences, AVG(occurences) OVER (PARTITION BY event_type) as event_avg FROM Events) a WHERE a.occurences > a.event_avg GROUP BY a.business_id HAVING COUNT(DISTINCT a.event_type) > 1"
208,"SELECT e.business_id FROM Events AS e INNER JOIN (SELECT event_type, AVG(occurences) AS avg_occu FROM Events GROUP BY event_type) AS a ON e.event_type = a.event_type WHERE e.occurences > a.avg_occu GROUP BY e.business_id HAVING COUNT(e.event_type) >= 2"
212,"SELECT e1.business_id FROM Events e1 LEFT JOIN (SELECT event_type, AVG(occurrences) AS avg_occur FROM Events GROUP BY event_type) e2 ON e1.event_type = e2.event_type WHERE e1.occurences > e2.avg_occur GROUP BY e1.business_id HAVING COUNT(*) > 1"
214,"SELECT business_id FROM (SELECT e1.business_id, e1.event_type, e1.occurences, AVG(e2.occurences) OVER(PARTITION BY e2.event_type) as avg_occ 
FROM events e1 
JOIN events e2 ON e1.event_type = e2.event_type) 
WHERE occurences > avg_occ 
GROUP BY business_id 
HAVING COUNT(DISTINCT event_type) > 1"
219,"SELECT a.business_id FROM Events a INNER JOIN (SELECT event_type, AVG(occurences) AS avg_cnt FROM Events GROUP BY event_type) b ON a.event_type = b.event_type WHERE a.occurences > b.avg_cnt GROUP BY a.business_id HAVING COUNT(a.event_type) > 1"
220,"SELECT business_id FROM (SELECT business_id, occurences, AVG(occurences) OVER(PARTITION BY event_type) as avg_occ FROM events) as a WHERE occurences > avg_occ GROUP BY business_id HAVING COUNT(business_id) > 1"
228,"SELECT business_id FROM (SELECT business_id, event_type, occurences, AVG(occurences) OVER (PARTITION BY event_type) as avg_occ FROM Events) AS temp WHERE occurences > avg_occ GROUP BY business_id HAVING COUNT(event_type) > 1"
233,"SELECT business_id FROM ( SELECT business_id, event_type, occurences, AVG(occurences) OVER (PARTITION BY event_type) as occurences_average FROM events) as a WHERE occurences > occurences_average GROUP BY business_id HAVING COUNT(business_id) > 1"
234,"SELECT business_id FROM (SELECT business_id, event_type, occurences, AVG(occurences) OVER (PARTITION BY event_type) AS average FROM Events) AS c WHERE occurences > average GROUP BY business_id HAVING COUNT(*) > 1"
239,"SELECT business_id FROM (SELECT business_id, event_type, occurences, AVG(occurences) OVER (PARTITION BY event_type) as avgoccurences FROM Events) AS a WHERE occurences > avgoccurences GROUP BY business_id HAVING COUNT(DISTINCT event_type) > 1"
241,"SELECT e.business_id FROM (SELECT event_type, AVG(occurences) AS avg_occ FROM Events GROUP BY event_type) a JOIN Events e ON a.event_type = e.event_type AND a.avg_occ < e.occurences GROUP BY e.business_id HAVING COUNT(DISTINCT e.event_type) > 1"
242,"SELECT e.business_id FROM Events e INNER JOIN (SELECT event_type, AVG(occurences) as avg_occurences FROM Events GROUP BY event_type) avg ON e.event_type = avg.event_type WHERE e.occurences > avg.avg_occurences GROUP BY e.business_id HAVING COUNT(e.event_type) > 1"
243,"SELECT e.business_id FROM Events e WHERE e.occurences > (SELECT AVG(occurences) FROM Events e1 WHERE e1.event_type = e.event_type) GROUP BY e.business_id HAVING COUNT(DISTINCT e.event_type) > 1"
248,"SELECT e.business_id FROM Events e INNER JOIN (SELECT event_type, AVG(occurences) avg_occu FROM Events GROUP BY event_type) t ON e.event_type = t.event_type WHERE e.occurences > t.avg_occu GROUP BY e.business_id HAVING COUNT(DISTINCT t.event_type) > 1"
251,"SELECT e.business_id FROM (SELECT event_type, avg(occurences) AS avo FROM events GROUP BY event_type) as a INNER JOIN events e ON e.event_type = a.event_type WHERE e.occurences > a.avo GROUP BY e.business_id HAVING COUNT(DISTINCT e.event_type) >= 2"
253,"SELECT e.business_id FROM Events e WHERE e.business_id IN (SELECT e2.business_id FROM Events e2 INNER JOIN (SELECT event_type, AVG(occurences) AS avg_occ FROM Events GROUP BY event_type) t ON e2.event_type = t.event_type WHERE e2.occurences > t.avg_occ GROUP BY e2.business_id HAVING COUNT(e2.business_id) > 1)"
254,"SELECT e1.business_id FROM (SELECT business_id, event_type, AVG(occurences) as e_avg from Events GROUP BY business_id, event_type) e1 JOIN (SELECT event_type, AVG(occurences) as e_avg FROM Events GROUP BY event_type) e2 ON e1.event_type = e2.event_type WHERE e1.e_avg > e2.e_avg GROUP BY e1.business_id HAVING COUNT(e1.event_type) > 1"
256,"SELECT e2.business_id FROM Events e2 INNER JOIN (SELECT event_type, AVG(occurences) AS avg FROM Events GROUP BY event_type) temp ON e2.event_type = temp.event_type WHERE e2.occurences > temp.avg GROUP BY e2.business_id HAVING COUNT(*) >= 2"
259,"SELECT t1.business_id FROM (SELECT business_id, event_type, occurences FROM Events) t1 JOIN (SELECT event_type, AVG(occurences) AS mean FROM Events GROUP BY event_type) t2 ON t1.event_type = t2.event_type WHERE t1.occurences > t2.mean GROUP BY t1.business_id HAVING count(t1.business_id) > 1"
261,"SELECT e.business_id FROM (SELECT e.business_id, COUNT(e.event_type) AS event_count FROM events AS e LEFT JOIN (SELECT event_type, AVG(occurences) AS avg_occ FROM events GROUP BY event_type) AS t1 ON e.event_type = t1.event_type WHERE e.occurences > t1.avg_occ GROUP BY e.business_id) AS t2 WHERE t2.event_count > 1"
262,"SELECT e2.business_id FROM events e2 WHERE e2.occurences > (SELECT AVG(e1.occurences) FROM events e1 WHERE e1.event_type = e2.event_type) GROUP BY e2.business_id HAVING COUNT(e2.event_type) > 1"
397,"SELECT e2.business_id FROM Events e2 JOIN (SELECT event_type, AVG(occurences) AS average FROM Events GROUP BY event_type) AS temp1 ON e2.event_type = temp1.event_type AND e2.occurences > temp1.average GROUP BY e2.business_id HAVING COUNT(DISTINCT temp1.event_type) > 1"
